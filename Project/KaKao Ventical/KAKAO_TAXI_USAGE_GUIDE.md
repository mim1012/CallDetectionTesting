# 카카오 택시 자동 감지 앱 사용 가이드

## 주요 기능

1. **실시간 콜 감지**: 카카오 택시 기사용 앱의 노란색 "콜 수락" 버튼 자동 감지
2. **거리/금액 필터링**: 설정한 조건에 맞는 콜만 자동 수락
3. **완료콜 자동 삭제**: 5초마다 완료된 콜 목록 정리
4. **백그라운드 실행**: 카카오 택시 앱 사용 중에도 동작

## 설치 및 초기 설정

### 1. APK 설치
```bash
adb install -r app-debug.apk
```

### 2. 권한 설정
- 화면 녹화 권한 허용
- 오버레이 권한 허용
- 알림 권한 허용
- Shizuku 권한 (클릭 자동화용)

## 사용 방법

### 1. 필터 설정
1. 앱 실행 후 "필터링 테스트" 버튼 클릭
2. 기본 설정값:
   - 거리: 1.0km ~ 8.0km
   - 금액: 5,000원 ~ 30,000원
   - 키워드: "무안", "남악"

### 2. 자동 감지 시작
1. "화면 캡처 시작" 버튼 클릭
2. 화면 녹화 권한 승인
3. 앱이 백그라운드로 이동
4. 상단 알림바에서 제어 가능

### 3. 상단바 알림 컨트롤
- **재생/일시정지 버튼**: 감지 일시정지/재개
- **설정 버튼**: 메인 앱으로 이동
- **종료 버튼**: 감지 완전 중지

### 4. 플로팅 버튼
- 화면 우측에 떠있는 컨트롤 버튼
- 드래그하여 위치 이동 가능
- 클릭하면 확장 메뉴 표시

## 작동 원리

### 콜 감지 프로세스
1. 2초마다 화면 캡처
2. 카카오 택시 화면인지 확인
3. 노란색 "콜 수락" 버튼 감지
4. OCR로 거리/금액 정보 추출
5. 필터 조건 확인
6. 조건 충족 시 자동 클릭

### 완료콜 삭제
- 5초마다 화면 확인
- 콜 목록 화면에서 "담기" 버튼 자동 클릭
- 완료된 콜 정리

## 디버깅

### 디버그 파일 위치
```
/storage/emulated/0/Android/data/com.kakao.taxi.test/files/Pictures/KakaoTaxiDebug/
```

### 저장되는 파일
- 원본 스크린샷
- 버튼 감지 결과
- OCR 텍스트 추출 결과
- 감지 세션 로그

### 디버그 폴더 열기
메인 화면의 "디버그 폴더 열기" 버튼 클릭

## 주의사항

1. **Shizuku 설정 필요**
   - 자동 클릭을 위해 Shizuku 앱 설치 및 활성화 필요
   - ADB 또는 무선 디버깅으로 Shizuku 시작

2. **배터리 최적화 제외**
   - 설정 > 배터리 > 앱 배터리 사용량 관리
   - 카카오 택시 테스트 앱 제외

3. **화면 밝기**
   - 화면이 꺼지면 감지 불가
   - 화면 자동 꺼짐 시간 늘리기 권장

## 문제 해결

### 감지가 안 될 때
1. 카카오 택시 앱이 전면에 있는지 확인
2. 화면 캡처 권한 재승인
3. 디버그 폴더에서 스크린샷 확인

### 클릭이 안 될 때
1. Shizuku 활성화 확인
2. 접근성 설정 확인
3. 로그에서 오류 메시지 확인

### 필터가 작동하지 않을 때
1. OCR 초기화 대기 (첫 실행 시 몇 초 소요)
2. 필터 설정값 재확인
3. 디버그 로그에서 OCR 결과 확인