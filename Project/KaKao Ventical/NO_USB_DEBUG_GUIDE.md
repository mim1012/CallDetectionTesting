# 📱 USB/ADB 없이 디버깅하는 방법

## 🎯 실시간 시각적 디버깅

### 1. **플로팅 디버그 창**
앱 실행 시 화면에 작은 디버그 창이 떠서 실시간 상태 표시:

```
🔍 실시간 디버그
━━━━━━━━━━━━━━━━
화면캡처  🟢 성공 (87ms)
앱 감지   🟢 카카오 택시
버튼감지  🟡 검색중...
텍스트    ⚫ 대기
클릭      ⚫ 대기
속도      🟢 15 FPS
━━━━━━━━━━━━━━━━
[상세 로그 표시]
```

색상 의미:
- 🟢 녹색: 성공/정상
- 🟡 노란색: 처리중
- 🔴 빨간색: 실패/오류
- ⚫ 회색: 대기중

### 2. **스크린샷에 디버그 정보 표시**

각 단계별로 스크린샷에 직접 표시:

#### 화면 캡처 단계
```
┌─────────────────────────┐
│ ✅ 캡처 성공 1080x2400  │
│ 시간: 14:32:15.234      │
└─────────────────────────┘
```

#### 버튼 감지 단계
```
노란 버튼에 빨간 박스 + 정보 표시:
┌──────────────────┐
│ BTN1 (980,1250)  │
│ 신뢰도: 95%      │
└──────────────────┘
```

#### 클릭 시도 단계
```
클릭 위치에 동심원 + 결과:
    ⊕ (980,1250)
    ✅ 클릭 성공!
```

### 3. **토스트 메시지**
각 단계별로 즉시 피드백:
- "✅ 화면 캡처 성공"
- "✅ 노란 버튼 3개 발견"
- "❌ 클릭 실패: 접근성 권한 없음"

### 4. **갤러리에서 확인**
디버그 이미지가 자동 저장:
```
/Pictures/KakaoTaxiDebug/
├── debug_capture_20241120_143215.png
├── debug_button_20241120_143216.png
├── debug_click_20241120_143217.png
└── debug_error_20241120_143218.png
```

## 🔧 문제별 진단 방법

### "화면 캡처가 안돼요"
```kotlin
// 플로팅 디버그 창 확인
화면캡처  🔴 실패 (권한없음)

// 해결책 표시
→ 설정 > 권한 > 화면 녹화 허용
```

### "버튼을 못 찾아요"
```kotlin
// 디버그 이미지 확인
1. 갤러리 > KakaoTaxiDebug 폴더
2. 최신 이미지 확인
3. 노란색 픽셀이 보라색 점으로 표시됨
4. 버튼이 빨간 박스로 표시됨

// 문제 파악
- 노란 픽셀 없음 → UI 변경됨
- 박스 없음 → 버튼 크기 조건 미달
```

### "클릭이 안돼요"
```kotlin
// 클릭 위치 시각화
- 빨간 십자선: 클릭 시도 위치
- 녹색 원: 성공
- 빨간 원: 실패

// 실패 이유 표시
❌ 클릭 실패: AccessibilityService not connected
```

## 📊 자가 진단 기능

### 앱 내 진단 버튼
```kotlin
btnSelfDiagnose.setOnClickListener {
    runDiagnostics()
}

// 결과 화면 표시
┌─────────────────────────────┐
│ 🏥 자가 진단 결과           │
├─────────────────────────────┤
│ ✅ 권한: 모두 정상          │
│ ✅ 서비스: 실행중           │
│ ❌ 카카오앱: 감지 안됨      │
│ ✅ 화면캡처: 정상           │
│ ⚠️ 버튼감지: 테스트 필요    │
│ ✅ 클릭기능: 정상           │
└─────────────────────────────┘
```

## 🎬 실시간 녹화 모드

### 디버그 녹화 시작
```kotlin
// 10초간 모든 과정 녹화
btnRecordDebug.setOnClickListener {
    startDebugRecording(10) // 10초
}
```

녹화 내용:
- 화면 캡처 (초당 5프레임)
- 모든 감지 결과
- 클릭 시도
- 성공/실패 표시

## 💾 로그 파일 자동 생성

위치: `/Android/data/com.kakao.taxi.test/files/logs/`

### debug_summary.txt
```
=== 2024-11-20 14:32:15 ===
총 캡처: 156회
버튼 감지: 12회
클릭 시도: 12회
성공: 10회 (83%)

주요 오류:
- 14:32:45: 버튼 없음 (화면 전환중)
- 14:33:12: 클릭 실패 (좌표 벗어남)

평균 처리 시간:
- 캡처: 45ms
- 감지: 32ms
- 클릭: 15ms
- 총: 92ms
```

## 📱 간단 설정으로 디버그 모드

### settings.json
```json
{
  "debug": {
    "visual": true,        // 시각적 디버그
    "floating": true,      // 플로팅 창
    "screenshot": true,    // 스크린샷 저장
    "toast": true,         // 토스트 메시지
    "gallery": true,       // 갤러리 저장
    "detail_level": "high" // 상세도
  }
}
```

## 🚀 빠른 문제 해결

### 1. 즉시 확인
- 플로팅 디버그 창의 색상
- 토스트 메시지
- 갤러리 최신 이미지

### 2. 상세 분석
- 저장된 디버그 이미지
- 로그 파일
- 자가 진단 결과

### 3. 해결책
- 앱이 직접 문제 파악
- 해결 방법 제시
- 설정 화면으로 안내

## 🎯 디버그 모드 활성화

```kotlin
// MainActivity에서
chkDebugMode.isChecked = true

// 또는 설정에서
설정 > 개발자 옵션 > 시각적 디버그 ON
```

이제 USB 연결 없이도 모든 문제를 실시간으로 확인하고 해결할 수 있습니다!