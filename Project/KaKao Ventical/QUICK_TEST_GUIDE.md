# 🔥 빠른 문제 해결 가이드

## 💥 "캡처 요청중", "캡처 실패" 문제 해결

### 1. 즉시 진단하기
```
1. 앱 실행
2. "클릭 이벤트 테스트" 버튼을 3초간 길게 누르기
3. 진단 결과 확인:
   ❌ 접근성 활성화: OFF → 접근성 설정으로 이동
   ❌ 화면표시 권한: 없음 → 권한 설정으로 이동
   ❌ 캡처 활성화: 비활성 → MediaProjection 재요청
   ❌ 비트맵 존재: 없음 → 서비스 재시작
```

### 2. 가장 많은 문제들

#### 문제 1: 접근성 서비스 OFF
```
해결: 설정 → 접근성 → "카카오 택시 자동화" → ON
```

#### 문제 2: MediaProjection 권한 없음
```
해결: 
1. "화면 캡처 시작" 버튼 클릭
2. "지금 시작" 허용
3. 다시 캡처 시도
```

#### 문제 3: 화면 표시 권한 없음
```
해결: 설정 → 앱 → 특별한 접근 → 다른 앱 위에 표시 → 허용
```

### 3. 강제 해결법

#### 모든 서비스 재시작
```kotlin
// 진단에서 자동 실행됨
1. ScreenCaptureService 중지 → 재시작
2. AutoDetectionService 중지 → 재시작
3. 접근성 서비스 재연결
```

#### 권한 일괄 요청
```kotlin
// 진단이 자동으로 해당 설정 화면 열어줌
- 접근성 설정
- 화면 표시 권한 설정
- MediaProjection 권한 요청
```

### 4. 실시간 모니터링

#### 로그에서 확인할 것들
```
✅ "캡처 성공" → 정상
❌ "캡처 실패: 권한없음" → MediaProjection 재요청 필요
❌ "캡처 실패: 비트맵이 없음" → 서비스 재시작 필요
⚠️ "카카오 택시 앱 대기 중" → 카카오 앱 실행 필요
```

#### 디버그 상태 패널
```
📷 화면캡처: ✅ 성공 (87ms)     ← 이게 나와야 정상
🔍 버튼감지: 🔍 검색중...        ← 캡처 후 이 단계로
👆 클릭시도: ⚫ 대기            ← 버튼 찾으면 이 단계로
```

### 5. 한 번에 해결하기

#### 올인원 해결책
```
1. 앱 실행
2. "클릭 이벤트 테스트" 길게 누르기 (진단)
3. 토스트 메시지 따라 설정 변경
4. 앱으로 돌아와서 "화면 캡처 시작" 클릭
5. "지금 시작" 허용
6. 카카오 택시 앱 실행
7. 다시 테스트 앱으로 와서 캡처 상태 확인
```

### 6. 그래도 안 되면

#### 강제 초기화
```
1. 앱 강제 종료
2. 설정 → 앱 → 카카오 택시 테스트 → 저장공간 → 모든 데이터 삭제
3. 접근성 서비스 OFF → ON
4. 앱 재실행
5. 처음부터 다시 설정
```

#### 기기 재부팅
```
모든 방법이 안 되면 기기 재부팅 후 다시 시도
```

### 7. 성공 시 나타나는 로그
```
[14:32:15] ✅ MediaProjection 권한 허용됨
[14:32:16] ✅ 캡처 성공 1080x2400
[14:32:16] ✅ 카카오 화면 확인됨
[14:32:17] 🔍 노란 버튼 찾는 중...
[14:32:17] ✅ 버튼 1개 발견 (980, 1250)
[14:32:17] ✅ 클릭 성공!
```

이 순서로 나오면 완전히 정상 작동 중입니다!