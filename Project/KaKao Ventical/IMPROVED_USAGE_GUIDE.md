# 개선된 카카오 T 기사용 자동화 앱 사용 가이드

## 🆕 주요 개선사항

### 1. 로그 시스템 개선
- ✅ 변경사항만 업데이트 (동일한 로그 반복 방지)
- ✅ X 표시 시 상세한 이유를 로그에 표시
- ✅ 실패 원인을 구체적으로 표시

### 2. 플로팅 컨트롤 개선
- ✅ 재생/일시정지 버튼으로 감지 제어
- ✅ 플로팅 버튼 표시 문제 해결
- ✅ 드래그 가능한 컨트롤

### 3. 오류 감지 개선
- ✅ 노란색 감지 범위 확대 (R: 200-255, G: 150-240, B: 0-120)
- ✅ X 표시 이유 상세 표시
- ✅ 카카오 택시 앱 활성화 시에만 캡처

## 📱 설치 및 실행 방법

### 1. APK 빌드
```batch
build_apk.bat
```

### 2. 앱 설치
```bash
adb install -r app\build\outputs\apk\debug\app-debug.apk
```

### 3. 필수 권한 설정
1. **오버레이 권한** - 플로팅 버튼 표시용
2. **접근성 권한** - 자동 클릭용
3. **화면 녹화 권한** - 화면 캡처용

## 🎮 플로팅 컨트롤 사용법

### 플로팅 버튼 표시
1. 앱 실행 후 "플로팅 컨트롤 표시" 버튼 클릭
2. 화면에 작은 원형 버튼 나타남
3. 버튼을 클릭하면 컨트롤 패널 확장

### 컨트롤 패널 기능
- **▶️ 재생 버튼**: 자동 감지 시작
- **⏸️ 일시정지 버튼**: 감지 중 → 일시정지로 전환
- **⏹️ 정지 버튼**: 자동 감지 완전 중지

## 🔍 디버그 정보 확인

### 메인 화면 상태 표시
- 📷 **화면캡처**: 캡처 상태
- 🔍 **버튼감지**: 노란 버튼 감지 상태
- 👆 **클릭시도**: 클릭 시도 결과
- 📍 **좌표**: 감지된 버튼 위치
- ♿ **접근성**: 서비스 활성화 상태

### X 표시 원인 확인
로그에 자동으로 표시되는 실패 이유:
- "노란색 버튼이 감지되지 않음"
- "버튼 크기 조건 미충족"
- "카카오 택시 화면 아님"
- 구체적인 오류 메시지

## 🚀 사용 시나리오

### 1. 기본 테스트
1. 앱 실행
2. "Mock 콜 화면 테스트"로 기능 확인
3. 플로팅 컨트롤 표시
4. ▶️ 버튼으로 감지 시작

### 2. 실제 사용
1. 카카오 T 기사용 앱 실행
2. 테스트 앱의 플로팅 버튼 표시
3. ▶️ 버튼 클릭하여 자동 감지 시작
4. 콜 목록 화면에서 대기

## 📊 문제 해결

### 플로팅 버튼이 안 보임
1. 설정 > 앱 > 특수 권한 > 다른 앱 위에 표시
2. "카카오 택시 테스트" 앱 권한 활성화
3. 앱에서 "플로팅 컨트롤 표시" 버튼 클릭

### X 표시가 계속 나타남
1. 메인 화면의 디버그 상태에서 이유 확인
2. 로그에서 구체적인 실패 원인 확인
3. "디버그 폴더 열기"로 캡처된 화면 확인

### 자동 클릭이 안 됨
1. 접근성 서비스 활성화 확인
2. Shizuku 실행 상태 확인 (선택사항)
3. 수동 알림 모드로 전환

## 💡 팁

### 최적 설정
- 화면 밝기: 최대
- 다크모드: OFF
- 배터리 최적화: 제외
- 알림: 모두 허용

### 디버그 모드 활용
1. 캡처 실패 시 자동으로 스크린샷 저장
2. 버튼 감지 실패 시 이유와 함께 기록
3. 모든 인식된 텍스트 표시 (필터 없음)

## 📁 디버그 파일 위치
```
/storage/emulated/0/Android/data/com.kakao.taxi.test/files/Pictures/KakaoTaxiDebug/
```

### 저장되는 파일
- `original_*.png` - 원본 캡처 화면
- `detection_*.png` - 버튼 감지 결과
- `not_kakao_screen_*.png` - 화면 인식 실패
- `detection_log_*.txt` - 상세 로그