# 📱 카카오 택시 자동화 테스트 가이드

## 1. Mock 환경 테스트 (권장)

### 준비사항
- 테스트 앱 설치
- 권한 설정 완료 (접근성, 화면 캡처, 알림)

### 테스트 단계

#### 1단계: Mock 콜 화면 테스트
```
1. 메인 화면에서 "Mock 콜 화면 테스트" 버튼 클릭
2. 가짜 카카오 택시 콜 화면이 표시됨
3. 노란색 "수락" 버튼이 자동으로 감지되는지 확인
4. 로그에서 감지 결과 확인
```

#### 2단계: 테스트 모드 활성화
```
1. "테스트 모드 (카카오 앱 체크 우회)" 체크박스 선택
2. 이제 모든 앱에서 노란색 버튼을 감지함
3. 다른 앱에서도 테스트 가능
```

#### 3단계: 디버그 상태 확인
```
📷 화면캡처: ✅ 캡처 성공
🔍 버튼감지: ✅ 버튼 1개 발견 (540, 1200)
👆 클릭시도: ✅ 클릭 성공!
📍 좌표: (540, 1200)
♿ 접근성: ✅ 연결됨
```

## 2. 초고속 모드 테스트

### 성능 측정 방법
```kotlin
// MainActivity에 추가
private fun testPerformance() {
    val startTime = System.currentTimeMillis()
    
    // 초고속 감지 시작
    startFastDetection()
    
    // 결과 측정
    lifecycleScope.launch {
        delay(5000) // 5초 테스트
        val endTime = System.currentTimeMillis()
        val captureCount = FastCallDetectionService.getCaptureCount()
        val avgTime = (endTime - startTime) / captureCount.toFloat()
        
        addLog("⚡ 성능 테스트 결과:")
        addLog("- 총 캡처 수: $captureCount")
        addLog("- 평균 처리 시간: ${avgTime}ms")
        addLog("- 초당 프레임: ${1000 / avgTime}")
    }
}
```

## 3. 실제 카카오 택시 앱 테스트

### ⚠️ 주의사항
- 실제 콜이 수락될 수 있으므로 주의
- 테스트 계정 사용 권장
- 비즈니스 시간 외 테스트

### 단계별 테스트

#### 1. 기본 감지 테스트
```
1. 카카오 택시 기사앱 실행
2. 테스트 앱에서 "화면 캡처 시작" 클릭
3. 카카오 택시 앱으로 전환
4. 콜 대기 화면에서 대기
5. 로그 확인:
   - "✅ 카카오 화면 확인됨"
   - "🔍 노란 버튼 찾는 중..."
```

#### 2. 자동 클릭 테스트
```
1. "플로팅 컨트롤 표시" 클릭
2. 플로팅 버튼에서 재생(▶) 클릭
3. 카카오 택시 앱에서 콜 대기
4. 콜이 들어오면 자동으로 수락되는지 확인
```

#### 3. 필터 테스트
```
1. 필터 설정:
   - 최소 금액: 50000원
   - 최대 거리: 10km
2. 조건에 맞는 콜만 자동 수락되는지 확인
```

## 4. 로그 분석

### 실시간 로그 보기
```
1. "실시간 로그 보기" 버튼 클릭
2. LogViewerActivity에서 실시간 확인
3. 필터링: "콜", "감지", "클릭" 등
```

### 디버그 폴더 확인
```
위치: /Android/data/com.kakao.taxi.test/files/debug/

- screenshots/: 캡처된 화면
- detection/: 감지 결과 (빨간 박스)
- ocr/: OCR 인식 결과
- logs/: 상세 로그 파일
```

## 5. 성능 최적화 테스트

### A/B 테스트
```kotlin
// 일반 모드 vs 초고속 모드
private fun comparePerformance() {
    // 일반 모드 (2초 간격)
    startAutoDetection()
    measurePerformance("일반 모드")
    
    // 초고속 모드 (0.1초 간격)
    startFastDetection()
    measurePerformance("초고속 모드")
}
```

### 배터리 소모 테스트
```
1. 배터리 100% 충전
2. 1시간 동안 실행
3. 배터리 소모량 측정
   - 일반 모드: ~5%
   - 초고속 모드: ~15%
```

## 6. 트러블슈팅

### 감지 안됨
- [ ] 접근성 서비스 활성화 확인
- [ ] 화면 캡처 권한 확인
- [ ] 테스트 모드 활성화
- [ ] 카카오 앱 최신 버전 확인

### 클릭 안됨
- [ ] 접근성 서비스 권한 확인
- [ ] 좌표가 정확한지 로그 확인
- [ ] 화면 해상도 차이 확인

### 너무 느림
- [ ] 초고속 모드 사용
- [ ] 다른 앱 종료
- [ ] 기기 재시작

## 7. 자동화 시나리오

### 시나리오 1: 고액 콜만 수락
```
필터 설정:
- 최소 금액: 100,000원
- 최대 거리: 5km
- 자동 수락: ON

결과: 10만원 이상, 5km 이내 콜만 자동 수락
```

### 시나리오 2: 야간 전체 수락
```
시간 설정:
- 시작: 23:00
- 종료: 05:00
- 필터: OFF

결과: 야간 시간대 모든 콜 자동 수락
```

### 시나리오 3: 피크타임 선별 수락
```
시간: 07:00-09:00, 18:00-20:00
필터:
- 최소 금액: 30,000원
- 프리미엄 콜 우선

결과: 출퇴근 시간 고액 콜 우선 수락
```

## 8. 데이터 수집 및 분석

### 수락률 분석
```kotlin
// 일별 통계
data class DailyStats(
    val date: String,
    val totalCalls: Int,
    val acceptedCalls: Int,
    val rejectedCalls: Int,
    val avgResponseTime: Long,
    val totalEarnings: Int
)
```

### 패턴 학습
```
- 시간대별 콜 빈도
- 지역별 평균 금액
- 요일별 패턴
- 날씨별 수요
```

## 9. 안전 장치

### 비상 정지
- 볼륨 다운 버튼 3번 연속: 즉시 중지
- 전원 버튼 2번: 일시 정지
- 플로팅 X 버튼: 종료

### 자동 복구
- 앱 크래시 시 자동 재시작
- 네트워크 오류 시 재연결
- 권한 해제 시 알림

## 10. 법적 주의사항

⚠️ **경고**: 이 앱은 테스트 목적으로만 사용하세요.
- 실제 영업에 사용 시 약관 위반 가능
- 부정 사용으로 인한 제재 가능
- 개발자는 책임지지 않음